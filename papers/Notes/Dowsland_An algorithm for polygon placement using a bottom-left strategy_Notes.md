样件排放策略：《An algorithm for polygon placement using a bottom-left strategy》

通过样件排放顺序后，下一步即为确定样件的旋转角度和排放位置。

Bottom Left：给定一样件排样顺序，待排样件j在满足与其他样件不重叠的前提下尽可能地靠左移动，如果此时有多个可选位置，则选择$y$坐标最低的那个位置。算法的目标是在矩形容器宽度一定的情况下尽可能降低长度。算法具体过程如下：

每一个样件的顶点的坐标是相对于参考点坐标定义的，而样件的参考点坐标是样件的外接矩形的左下角坐标。

对于样件$j$绕样件$i$移动得到$NFP_{ij}$.记$NFP_{ij}$的内部为$int(NFP_{ij})$。如果样件$i$放置在坐标$u=(x_i,y_i)$处，样件$j$放置在$v=(x_j,y_j)$处，那么如果$v-u$在$NFP_{ij}$的内部。那么样件$i$和$j$重叠；如果$v-u$在$NFP_{ij}$的边界。那么样件$i$和$j$将会接触，也即是$NFP_{ij}+（x_i,y_i）=(x_j,y_j)$。

现假定$(x_i,y_i)$和$(x_j,y_j)$分别是固定的多边形$i$和待排的多边形$j$的参考点，则有：

a). $NFP_{ij}+（x_i,y_i）=(x_j,y_j)$

b).如果$(x_j,y_j)$没有在$NFP_{kj}$内部$(k=1,2,…,j-1)$，则$(x_j,y_j)$是一个可行的位置。

按bottom left策略放置样件$j$的过程如下：

1.对于每一个已排好的样件$i$，让$(x_i^*,y_i^*)$是$NFP_{ij}$边界上最左点，以便对于任意排好的样件$k,k=1,…,i-1,k≠j$，满足不在$NFP_{ik}$内部。如果没有那样的存在，则设置$(x_i^*,y_i^*)=(\infty,\infty)$

2.设置待排样件$j$的参考点为$(x_j,y_j)=\{(x_{imin}^*,y_{imin}^*):x_{imin}^*\leq x_i^*\forall i=1,j-1\}$。

当有多个$x_i^*$时，选择最小的$y_i^*$。对于上面的论述，查找可以看作是查找$NFP_{ij}$每一条边的最左可行点，然后从这些所有最左可行点当中找出最左的那个点。照此看来，我们也没必要去单独考虑每个NFP，只需要考虑所有NFP的所有边的最左最下的那个可行点位置。接下来，设置$E$是$NFP_{ij}$的所有边的集合，$i=1,\cdots,j-1$，设置$(x_m^*,y_m^*)$是$E$中边$m$的最左点以满足$(x_m^*,y_m^*)$不在$NFP_{kj}$内部的要求，其中$\forall k=1,\cdots,j-1$，这样做的原因是保证待排样的样件不能与已排样的样件重叠。接下来设置$(x_j,y_j)=\{(x_{mmin}^*,y_{mmin}^*):x_{mmin}^*\geq x_m^*,\forall m\in E\}$以查找最左最下的可行位置点。当有多个$x_i^*$时，选择最小的$y_i^*$。

在以上考虑中，待排样件放置时也可能于容器的左壁边接触，所以需要将容器这条左边加入到集合$E$中。需要考虑的是，当$x_j<0$或者$y_j<0$时，样件将会超过容器的左边和最下边，同样，假设样件外接矩形的宽度为$w_j$，如果$y_j>W-w_j$，那么待排样件将会超过容器的顶部。

现在排样放置策略算法流程正式变为如下：

1.  放置第1个样件位于$(0,0)$位置，然后设置$j=2$.

2.  设置$(x_j,y_j)=(\infty,\infty)$

3.  设置$E=\{e_1,e_2,\cdots,e_k\}$是$NFP_{ij}$的所有边的集合，其中$i=1,\cdots,j-1$

4.  设置$e_{k+1}$是容器的左边，则$E=E\cup e_{k+1}$。

5.  按着矩形$(0,0,M,W-w_i)$裁剪$E$中的所有边，$M$尽量为容器的长度值。

6.  查找$(x_m^*,y_m^*)$，其中$m=1,\cdots,k+1$。设置$(x_j,y_j)=\{(x_{m\min}^*,y_{m\min}^*):x_{m\min}^*\leq x_m^*,\forall e_m\in E\}$。当有多个$x_m^*$时，选择最小的$y_m^*$。

7.  设置$j=j+1$,如果$j<=n$，($n$为待排样件数)，则跳转到步骤2，否则停止。

接下来讨论具体如何查找步骤6中的坐标$(x_m^*,y_m^*)$。对于查找任意一条边$e_m$的最左可行点$(x_m^*,y_m^*)$，具体程序如下：

1.  设置位置点v为边$e_m$初始的最左点。

2.  判断v是否在$NFP_{kj}$内，其中$k=1,…,j-1$，在其内则判定重叠。如果查遍所有的NFP都没有判定其在某个NFP内，则对于样件$j$一个可行的最左最下位置点被找到。否则在当前的位置点$v$放置样件$j$后与原排样样件重叠，此时进入步骤3

3. 计算边$e_m$和$NFP_{jk}$的所有边的所有交点，如果没有交点存在则说明边$m$上没有可行的位置点。否则令$(x_p,y_p)$为所有交点中最接近$v$的点，并令$v=(x_p,y_p)$然后跳转到步骤2

提升bottom left的计算复杂度：

对边集合$E$中的所有边按照其$x$坐标升序排列，形成边排序列表$L$，假定$(x_m^*,y_m^*)$是已经排序的列表$L$中边-m上找到的移动形状的最左可行位置。遍历排序列表$L$，直到遍历的边的第一个端点位于$x_m^*$右边，说明$L$中剩下未遍历的所有边的第一个端点的$x$坐标大于等于$x_m^*$，此时继续搜索最左的可行位置已经没有必要，因此遍历停止。

对于孔洞：因为每次寻找的是最左的可行位置，所以已经包含了孔洞的情况。